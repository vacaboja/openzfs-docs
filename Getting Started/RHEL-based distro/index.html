<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RHEL-based distro &mdash; OpenZFS  documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/mandoc.css" type="text/css" /><link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Rocky Linux 8 Root on ZFS" href="RHEL 8-based distro Root on ZFS.html" />
    <link rel="prev" title="openSUSE Tumbleweed Root on ZFS" href="../openSUSE/openSUSE Tumbleweed Root on ZFS.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #29667e" >
            <a href="../../index.html"><img src="../../_static/logo_main.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Arch Linux/index.html">Arch Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Debian/index.html">Debian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fedora/index.html">Fedora</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FreeBSD.html">FreeBSD</a></li>
<li class="toctree-l2"><a class="reference external" href="https://wiki.gentoo.org/wiki/ZFS">Gentoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../NixOS/index.html">NixOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openSUSE/index.html">openSUSE</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">RHEL-based distro</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#contents">Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="RHEL 8-based distro Root on ZFS.html">Rocky Linux 8 Root on ZFS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dkms">DKMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kabi-tracking-kmod">kABI-tracking kmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-repositories">Testing Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rhel-8-based-distro-root-on-zfs">RHEL 8-based distro Root on ZFS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/0-overview.html">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/1-preparation.html">Preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/2-system-installation.html">System Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/3-system-configuration.html">System Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/5-bootloader.html">Bootloader</a></li>
<li class="toctree-l4"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/6-recovery.html">Recovery</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Ubuntu/index.html">Ubuntu</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Project and Community/index.html">Project and Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developer Resources/index.html">Developer Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Performance and Tuning/index.html">Performance and Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Basic Concepts/index.html">Basic Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/index.html">Man Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../msg/index.html">ZFS Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../License.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #29667e" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OpenZFS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Getting Started</a> &raquo;</li>
      <li>RHEL-based distro</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/openzfs/openzfs-docs/blob/master/docs/Getting Started/RHEL-based distro/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="rhel-based-distro">
<h1>RHEL-based distro<a class="headerlink" href="#rhel-based-distro" title="Permalink to this headline"></a></h1>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="RHEL 8-based distro Root on ZFS.html">Rocky Linux 8 Root on ZFS</a></li>
</ul>
</div>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Dynamic_Kernel_Module_Support">DKMS</a> or <a class="reference external" href="https://elrepoproject.blogspot.com/2016/02/kabi-tracking-kmod-packages.html">kABI-tracking kmod</a> style packages are provided for RHEL and
CentOS based distributions from the OpenZFS repository. These packages are
updated as new versions are released. Only the current repository for each
major release is updated with new packages. Packages are available for the
following configurations:</p>
<div class="line-block">
<div class="line"><strong>EL Releases:</strong> 6, 7.9, 8.5</div>
<div class="line"><strong>Architectures:</strong> x86_64</div>
</div>
<p>To simplify installation a <em>zfs-release</em> package is provided which includes
a zfs.repo configuration file and public signing key. All official OpenZFS
packages are signed using this key, and by default yum or dnf will verify a
package’s signature before allowing it be to installed. Users are strongly
encouraged to verify the authenticity of the ZFS on Linux public key using
the fingerprint listed here.</p>
<div class="line-block">
<div class="line"><strong>Location:</strong> /etc/pki/rpm-gpg/RPM-GPG-KEY-zfsonlinux</div>
<div class="line"><strong>EL6 Package:</strong> <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el6.noarch.rpm">zfs-release.el6.noarch.rpm</a> (zfs-0.8.x)</div>
<div class="line"><strong>EL7.9 Package:</strong> <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el7_9.noarch.rpm">zfs-release.el7_9.noarch.rpm</a> (zfs-0.8.x)</div>
<div class="line"><strong>EL8.5 Package:</strong> <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el8_5.noarch.rpm">zfs-release.el8_5.noarch.rpm</a> (&gt;= zfs-2.0.5)</div>
<div class="line"><strong>Archived Repositories:</strong> <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el7_5.noarch.rpm">el7_5</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el7_6.noarch.rpm">el7_6</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el7_7.noarch.rpm">el7_7</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el7_8.noarch.rpm">el7_8</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el8_0.noarch.rpm">el8_0</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el8_1.noarch.rpm">el8_1</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el8_2.noarch.rpm">el8_2</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el8_3.noarch.rpm">el8_3</a>, <a class="reference external" href="https://zfsonlinux.org/epel/zfs-release.el8_4.noarch.rpm">el8_4</a></div>
<div class="line"><strong>List of Repositories</strong> <a class="reference external" href="https://github.com/zfsonlinux/zfsonlinux.github.com/tree/master/epel">see repo page</a></div>
</div>
<div class="line-block">
<div class="line"><strong>Download from:</strong>
<a class="reference external" href="https://pgp.mit.edu/pks/lookup?search=0xF14AB620&amp;op=index&amp;fingerprint=on">pgp.mit.edu</a></div>
<div class="line"><strong>Fingerprint:</strong> C93A FFFD 9F3F 7B03 C310 CEB6 A9D5 A1C0 F14A B620</div>
</div>
<p>For RHEL/CentOS versions 6 and 7 run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>yum install https://zfsonlinux.org/epel/zfs-release$(rpm -E %distro).noarch.rpm
rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-zfsonlinux
</pre></div>
</div>
<p>And for RHEL 8.5:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">install</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">zfsonlinux</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">epel</span><span class="o">/</span><span class="n">zfs</span><span class="o">-</span><span class="n">release</span><span class="o">.</span><span class="n">el8_5</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">rpm</span> <span class="o">--</span><span class="kn">import</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">rpm</span><span class="o">-</span><span class="n">gpg</span><span class="o">/</span><span class="n">RPM</span><span class="o">-</span><span class="n">GPG</span><span class="o">-</span><span class="n">KEY</span><span class="o">-</span><span class="n">zfsonlinux</span>
</pre></div>
</div>
<p>After installing the <em>zfs-release</em> package and verifying the public key
users can opt to install either the DKMS or kABI-tracking kmod style packages.
DKMS packages are recommended for users running a non-distribution kernel or
for users who wish to apply local customizations to OpenZFS.  For most users
the kABI-tracking kmod packages are recommended in order to avoid needing to
rebuild OpenZFS for every kernel update.</p>
</div>
<div class="section" id="dkms">
<h2>DKMS<a class="headerlink" href="#dkms" title="Permalink to this headline"></a></h2>
<p>To install DKMS style packages issue the following commands. First add the
<a class="reference external" href="https://fedoraproject.org/wiki/EPEL">EPEL repository</a> which provides DKMS by installing the <em>epel-release</em>
package, then the <em>kernel-devel</em> and <em>zfs</em> packages. Note that it is
important to make sure that the matching <em>kernel-devel</em> package is installed
for the running kernel since DKMS requires it to build OpenZFS.</p>
<p>For RHEL/CentOS versions 6 and 7, separately run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">epel</span><span class="o">-</span><span class="n">release</span>
<span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">kernel</span><span class="o">-</span><span class="n">devel</span>
<span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">zfs</span>
</pre></div>
</div>
<p>And for RHEL/CentOS 8 and newer, separately run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">epel</span><span class="o">-</span><span class="n">release</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">kernel</span><span class="o">-</span><span class="n">devel</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">zfs</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When switching from DKMS to kABI-tracking kmods first uninstall the
existing DKMS packages. This should remove the kernel modules for all
installed kernels, then the kABI-tracking kmods can be installed as
described in the section below.</p>
</div>
</div>
<div class="section" id="kabi-tracking-kmod">
<h2>kABI-tracking kmod<a class="headerlink" href="#kabi-tracking-kmod" title="Permalink to this headline"></a></h2>
<p>By default the <em>zfs-release</em> package is configured to install DKMS style
packages so they will work with a wide range of kernels. In order to
install the kABI-tracking kmods the default repository must be switched
from <em>zfs</em> to <em>zfs-kmod</em>. Keep in mind that the kABI-tracking kmods are
only verified to work with the distribution provided kernel.</p>
<p>For RHEL/CentOS versions 6 and 7 run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">disable</span> <span class="n">zfs</span>
<span class="n">yum</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">enable</span> <span class="n">zfs</span><span class="o">-</span><span class="n">kmod</span>
<span class="n">yum</span> <span class="n">install</span> <span class="n">zfs</span>
</pre></div>
</div>
<p>And for RHEL/CentOS 8 and newer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">disable</span> <span class="n">zfs</span>
<span class="n">dnf</span> <span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">enable</span> <span class="n">zfs</span><span class="o">-</span><span class="n">kmod</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="n">zfs</span>
</pre></div>
</div>
<p>By default the OpenZFS kernel modules are automatically loaded when a ZFS
pool is detected. If you would prefer to always load the modules at boot
time you must create an <code class="docutils literal notranslate"><span class="pre">/etc/modules-load.d/zfs.conf</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="n">zfs</span> <span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">modules</span><span class="o">-</span><span class="n">load</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">zfs</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When updating to a new RHEL/CentOS minor release the existing kmod
packages may not work due to upstream kABI changes in the kernel.
After upgrading users must uninstall OpenZFS and then reinstall it
from the matching repository as described in this section.</p>
</div>
<p>It might be necessary to rebuild ZFS module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for directory in /lib/modules/*; do
  kernel_version=$(basename $directory)
  dkms autoinstall -k $kernel_version
done
</pre></div>
</div>
<p>If for some reason, ZFS kernel module is not successfully built,
you can also run the above command to debug the problem.</p>
</div>
<div class="section" id="testing-repositories">
<h2>Testing Repositories<a class="headerlink" href="#testing-repositories" title="Permalink to this headline"></a></h2>
<p>In addition to the primary <em>zfs</em> repository a <em>zfs-testing</em> repository
is available. This repository, which is disabled by default, contains
the latest version of OpenZFS which is under active development. These
packages are made available in order to get feedback from users regarding
the functionality and stability of upcoming releases. These packages
<strong>should not</strong> be used on production systems. Packages from the testing
repository can be installed as follows.</p>
<p>For RHEL/CentOS versions 6 and 7 run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">enable</span> <span class="n">zfs</span><span class="o">-</span><span class="n">testing</span>
<span class="n">yum</span> <span class="n">install</span> <span class="n">kernel</span><span class="o">-</span><span class="n">devel</span> <span class="n">zfs</span>
</pre></div>
</div>
<p>And for RHEL/CentOS 8 and newer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">enable</span> <span class="n">zfs</span><span class="o">-</span><span class="n">testing</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="n">kernel</span><span class="o">-</span><span class="n">devel</span> <span class="n">zfs</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <em>zfs-testing</em> for DKMS packages and <em>zfs-testing-kmod</em>
kABI-tracking kmod packages.</p>
</div>
</div>
<div class="section" id="rhel-8-based-distro-root-on-zfs">
<h2>RHEL 8-based distro Root on ZFS<a class="headerlink" href="#rhel-8-based-distro-root-on-zfs" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="RHEL%208-based%20distro%20Root%20on%20ZFS/0-overview.html">Start here</a>.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/0-overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/1-preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/2-system-installation.html">System Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/3-system-configuration.html">System Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/5-bootloader.html">Bootloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="RHEL 8-based distro Root on ZFS/6-recovery.html">Recovery</a></li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../openSUSE/openSUSE Tumbleweed Root on ZFS.html" class="btn btn-neutral float-left" title="openSUSE Tumbleweed Root on ZFS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="RHEL 8-based distro Root on ZFS.html" class="btn btn-neutral float-right" title="Rocky Linux 8 Root on ZFS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, OpenZFS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>